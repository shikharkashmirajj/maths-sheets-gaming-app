<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Maths Sheets Gaming App</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#0f172a" />
  <style>
    body { font-family: Arial, sans-serif; background:#f5f5f5; margin:0; padding-bottom:70px; text-align:center; }
    h1 { background:#0f172a; color:white; padding:15px; margin:0; }
    .topic { background:white; margin:10px; padding:15px; border-radius:12px; box-shadow:0 2px 5px rgba(0,0,0,0.1); display:flex; justify-content:space-between; align-items:center; }
    .btn { padding:8px 14px; border:none; border-radius:8px; background:#4CAF50; color:white; font-weight:bold; cursor:pointer; }
    .btn:disabled { background:gray; cursor:default; }
    .card { background:white; margin:20px auto; padding:20px; width:85%; border-radius:12px; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
    .progress-container { margin:15px auto; width:80%; background:#ddd; border-radius:10px; height:20px; }
    .progress-bar { height:100%; width:0%; background:#4CAF50; border-radius:10px; text-align:center; color:white; font-size:12px; line-height:20px; }
    .extra-actions { margin:15px; }
    .extra-btn { margin:5px; padding:10px 16px; border:none; border-radius:10px; background:#2196F3; color:white; font-weight:bold; cursor:pointer; }
    /* Bottom navigation */
    .bottom-nav {
      position:fixed; bottom:0; left:0; width:100%;
      background:#1e293b; display:flex; justify-content:space-around;
      padding:8px 0; box-shadow:0 -2px 6px rgba(0,0,0,0.3);
    }
    .bottom-nav button {
      background:none; border:none; color:white;
      font-size:1.2em; flex:1;
      display:flex; flex-direction:column; align-items:center; cursor:pointer;
    }
    .hidden { display:none; }
    .ladder { text-align:left; margin:20px; }
    .ladder div { margin:10px 0; font-size:1.1em; }
  </style>
</head>
<body>
  <h1>ğŸ“˜ Maths Sheets Gaming App</h1>

  <!-- Dashboard Page -->
  <div id="dashboard">
    <div id="scoreboard" class="card">
      <div>â­ Points: <span id="points">0</span></div>
      <div>ğŸ”¥ Streak: <span id="streak">0</span> days</div>
      <div class="progress-container">
        <div class="progress-bar" id="progressBar">0%</div>
      </div>
    </div>

    <div class="extra-actions">
      <button class="extra-btn" onclick="addMockTest()">ğŸ“‘ Completed Mock Test (+500 XP)</button>
      <button class="extra-btn" onclick="addRevision()">ğŸ“– Revised Notes (+200 XP)</button>
    </div>

    <div id="topics"></div>
  </div>

  <!-- Rank Page -->
  <div id="rankPage" class="hidden">
    <div class="card">
      <h2>Your Current Rank</h2>
      <p id="rankText">Loading...</p>
      <p>â­ Total Points: <span id="pointsRank">0</span></p>
    </div>
    <div class="card">
      <h2>Rank Ladder</h2>
      <div class="ladder">
        <div>ğŸ¥‰ 0â€“5,000 XP â†’ Apprentice</div>
        <div>âš¡ 5,001â€“15,000 XP â†’ Speed Solver</div>
        <div>ğŸ¥· 15,001â€“30,000 XP â†’ Shortcut Ninja</div>
        <div>ğŸ† 30,001+ XP â†’ CGL Maths Master</div>
      </div>
    </div>
  </div>

  <!-- Bottom Navigation -->
  <div class="bottom-nav">
    <button onclick="showPage('dashboard')">ğŸ <span style="font-size:0.75em;">Dashboard</span></button>
    <button onclick="showPage('rankPage')">ğŸ†<span style="font-size:0.75em;">Rank</span></button>
  </div>

  <script>
    // Data storage
    let points = parseInt(localStorage.getItem("points")) || 0;
    let streak = parseInt(localStorage.getItem("streak")) || 0;
    let lastDate = localStorage.getItem("lastDate") || "";
    let completed = JSON.parse(localStorage.getItem("completed")) || {};

    function saveProgress() {
      localStorage.setItem("points", points);
      localStorage.setItem("completed", JSON.stringify(completed));
      document.getElementById("points").innerText = points;
      document.getElementById("pointsRank").innerText = points;
      updateRank(points);
      updateProgress();
    }

    function updateRank(points) {
      let rank = "Apprentice ğŸ¥‰";
      if (points > 30000) rank = "CGL Maths Master ğŸ†";
      else if (points > 15000) rank = "Shortcut Ninja ğŸ¥·";
      else if (points > 5000) rank = "Speed Solver âš¡";
      document.getElementById("rankText").innerText = rank;
    }

    const today = new Date().toDateString();
    if (today !== lastDate) {
      streak++;
      localStorage.setItem("lastDate", today);
      localStorage.setItem("streak", streak);
    }

    document.getElementById("points").innerText = points;
    document.getElementById("pointsRank").innerText = points;
    document.getElementById("streak").innerText = streak;
    updateRank(points);

    function updateProgress() {
      const TOPICS = ["average","algebra","coordinate","geometry","hcf","height","mens","mixture","numbers","percent","pnl","sici","stats","surds","trig","tsd","twp"];
      const done = Object.keys(completed).length;
      const total = TOPICS.length;
      const percent = Math.round((done / total) * 100);
      const bar = document.getElementById("progressBar");
      bar.style.width = percent + "%";
      bar.innerText = percent + "%";
    }
    updateProgress();

    const TOPICS = [
      { key:"average", name:"âš–ï¸ Average" },
      { key:"algebra", name:"â• Algebra" },
      { key:"coordinate", name:"ğŸ“ Coordinate Geometry" },
      { key:"geometry", name:"ğŸ“ Geometry" },
      { key:"hcf", name:"â— HCF" },
      { key:"height", name:"â›°ï¸ Height & Distance" },
      { key:"mens", name:"ğŸ“¦ Mensuration" },
      { key:"mixture", name:"ğŸ§ª Mixture" },
      { key:"numbers", name:"ğŸ”¢ Number System" },
      { key:"percent", name:"ğŸ“Š Percentage" },
      { key:"pnl", name:"ğŸ’° Profit & Loss" },
      { key:"sici", name:"ğŸ’µ SI & CI" },
      { key:"stats", name:"ğŸ“ˆ Statistics" },
      { key:"surds", name:"âˆš Surds" },
      { key:"trig", name:"ğŸ“ Trigonometry" },
      { key:"tsd", name:"ğŸš— Time, Speed & Distance" },
      { key:"twp", name:"â³ Time & Work" }
    ];

    const container = document.getElementById("topics");
    TOPICS.forEach(topic => {
      const div = document.createElement("div");
      div.className = "topic";
      div.innerHTML = `<span>${topic.name}</span>
        <button class="btn" id="btn-${topic.key}">Mark Done</button>`;
      container.appendChild(div);

      if (completed[topic.key]) {
        div.querySelector("button").disabled = true;
        div.querySelector("button").innerText = "âœ… Done";
      }

      div.querySelector("button").addEventListener("click", () => {
        points += 100;
        completed[topic.key] = true;
        saveProgress();
        div.querySelector("button").disabled = true;
        div.querySelector("button").innerText = "âœ… Done";
      });
    });

    function addMockTest() {
      points += 500;
      saveProgress();
      alert("ğŸ‰ You earned +500 XP for completing a Mock Test!");
    }
    function addRevision() {
      points += 200;
      saveProgress();
      alert("ğŸ“– You earned +200 XP for revising your notes!");
    }

    function showPage(pageId) {
      document.getElementById("dashboard").classList.add("hidden");
      document.getElementById("rankPage").classList.add("hidden");
      document.getElementById(pageId).classList.remove("hidden");
    }
  </script>
</body>
</html>
